# âš¡ Quick Start: Invitaciones con Server Actions

## ğŸ¯ SoluciÃ³n RÃ¡pida en 5 Pasos

### 1. Instalar Dependencias
```bash
cd tu-proyecto-nextjs
npm install @prisma/client resend
npm install -D prisma
```

### 2. Copiar Schema de Prisma
```bash
mkdir prisma
# Copia tu schema.prisma del backend a ./prisma/schema.prisma
npx prisma generate
```

### 3. Configurar .env.local
```bash
DATABASE_URL="tu-database-url-de-neon"
RESEND_API_KEY="tu-resend-api-key"
NEXT_PUBLIC_APP_URL="https://cresia-app.vercel.app"
```

### 4. Crear Archivos Base

#### `lib/prisma.ts`
```typescript
import { PrismaClient } from '@prisma/client'

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClient | undefined
}

export const prisma = globalForPrisma.prisma ?? new PrismaClient()

if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma
```

#### `lib/resend.ts`
```typescript
import { Resend } from 'resend'
export const resend = new Resend(process.env.RESEND_API_KEY)
```

### 5. Copiar Server Action
Copia el cÃ³digo de `app/actions/team-invitations.ts` del archivo `FRONTEND_SERVER_ACTIONS_INVITATIONS.md`

---

## ğŸ”¥ Uso Inmediato

### Desde cualquier componente Client:
```typescript
'use client'

import { sendTeamInvitation } from '@/app/actions/team-invitations'

export function InviteButton() {
  const handleInvite = async () => {
    const result = await sendTeamInvitation({
      teamId: 'tu-team-id',
      email: 'test@example.com',
      role: 'MIEMBRO',
      byUserId: 'tu-user-id',
      expiresInDays: 7
    })
    
    if (result.success) {
      alert('âœ… InvitaciÃ³n enviada!')
    } else {
      alert('âŒ Error: ' + result.error)
    }
  }
  
  return <button onClick={handleInvite}>Enviar InvitaciÃ³n</button>
}
```

### Desde Server Component:
```typescript
import { sendTeamInvitation } from '@/app/actions/team-invitations'

export default async function Page() {
  const result = await sendTeamInvitation({...})
  return <div>{result.success ? 'âœ…' : 'âŒ'}</div>
}
```

---

## âœ… Ventajas vs Fetch

| fetch() al backend | Server Actions |
|-------------------|----------------|
| âŒ Problemas de CORS | âœ… Sin CORS |
| âŒ ValidaciÃ³n doble | âœ… Una validaciÃ³n |
| âŒ Campos extra causan errores | âœ… Control total |
| âŒ Depende de Render | âœ… Independiente |
| âš ï¸ 2 hops (FE â†’ Render â†’ DB) | âœ… 1 hop (Server â†’ DB) |

---

## ğŸš€ Deploy a Vercel

1. Sube cÃ³digo a GitHub
2. Vercel despliega automÃ¡ticamente
3. Agrega variables de entorno en Vercel Dashboard:
   - `DATABASE_URL`
   - `RESEND_API_KEY`
   - `NEXT_PUBLIC_APP_URL`

---

## ğŸ§ª Testing Local

```bash
npm run dev
```

Abre http://localhost:3000 y prueba enviar una invitaciÃ³n.

---

## ğŸ“ Checklist

- [ ] Dependencias instaladas
- [ ] Schema de Prisma copiado y generado
- [ ] Variables de entorno configuradas
- [ ] `lib/prisma.ts` creado
- [ ] `lib/resend.ts` creado
- [ ] Server action copiado a `app/actions/team-invitations.ts`
- [ ] Componente de formulario creado
- [ ] Testing local exitoso
- [ ] Variables en Vercel configuradas
- [ ] Deploy a Vercel exitoso

---

## ğŸ‰ Â¡Listo!

Ahora puedes enviar invitaciones directamente desde Next.js sin depender del backend de Render.

**Tiempo estimado:** 15-20 minutos
